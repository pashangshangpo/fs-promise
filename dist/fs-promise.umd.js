!function(n,t){"object"==typeof exports&&"undefined"!=typeof module?t(exports,require("fs"),require("path")):"function"==typeof define&&define.amd?define(["exports","fs","path"],t):t(n.fsPromise={},n.fs,n.path)}(this,function(n,t,e){t=t&&t.hasOwnProperty("default")?t.default:t,e=e&&e.hasOwnProperty("default")?e.default:e;const r=function(){function n(){}return n.prototype.then=function(t,e){const r=new n,o=this.s;if(o){const n=1&o?t:e;if(n){try{i(r,1,n(this.v))}catch(n){i(r,2,n)}return r}return this}return this.o=function(n){try{const o=n.v;1&n.s?i(r,1,t?t(o):o):e?i(r,1,e(o)):i(r,2,o)}catch(n){i(r,2,n)}},r},n}();function i(n,t,e){if(!n.s){if(e instanceof r){if(!e.s)return void(e.o=i.bind(null,n,t));1&t&&(t=e.s),e=e.v}if(e&&e.then)return void e.then(i.bind(null,n,t),i.bind(null,n,2));n.s=t,n.v=e;const o=n.o;o&&o(n)}}function o(n){return n instanceof r&&1&n.s}const u="undefined"!=typeof Symbol?Symbol.iterator||(Symbol.iterator=Symbol("Symbol.iterator")):"@@iterator";function f(n,t,e){if("function"==typeof n[u]){var f,c,s,l=n[u]();if(function n(u){try{for(;!((f=l.next()).done||e&&e());)if((u=t(f.value))&&u.then){if(!o(u))return void u.then(n,s||(s=i.bind(null,c=new r,2)));u=u.v}c?i(c,1,u):c=u}catch(n){i(c||(c=new r),2,n)}}(),l.return){var a=function(n){try{f.done||l.return()}catch(n){}return n};if(c&&c.then)return c.then(a,function(n){throw a(n)});a()}return c}if(!("length"in n))throw new TypeError("Object is not iterable");for(var h=[],m=0;m<n.length;m++)h.push(n[m]);return function(n,t,e){var u,f,c=-1;return function s(l){try{for(;++c<n.length&&(!e||!e());)if((l=t(c))&&l.then){if(!o(l))return void l.then(s,f||(f=i.bind(null,u=new r,2)));l=l.v}u?i(u,1,l):u=l}catch(n){i(u||(u=new r),2,n)}}(),u}(h,function(n){return t(h[n])},e)}"undefined"!=typeof Symbol&&(Symbol.asyncIterator||(Symbol.asyncIterator=Symbol("Symbol.asyncIterator")));var c=function(n){return new Promise(function(e){t.access(n,t.constants.F_OK,function(n){e(!n)})})},s=function(n){return new Promise(function(e){t.stat(n,function(n,t){e(!n&&t.isDirectory())})})},l=function(n){return new Promise(function(e){t.readdir(n,function(n,t){e(t||[])})})},a=function(n){try{var e=n.split("/");return e.pop(),Promise.resolve(c(e.join("/"))).then(function(r){function i(){return new Promise(function(e){t.mkdir(n,function(){try{return Promise.resolve(c(n)).then(function(n){e(n)})}catch(n){return Promise.reject(n)}})})}var o=function(){if(!r)return Promise.resolve(a(e.join("/"))).then(function(){})}();return o&&o.then?o.then(i):i()})}catch(n){return Promise.reject(n)}},h=function(n){return new Promise(function(e){t.unlink(n,function(n){e(!n)})})},m=function(n){try{return Promise.resolve(l(n)).then(function(r){function i(){return new Promise(function(e){t.rmdir(n,function(n){e(!n)})})}var o=f(r,function(t){var r=e.join(n,t);return Promise.resolve(s(r)).then(function(n){var t=n?Promise.resolve(m(r)).then(function(){}):Promise.resolve(h(r)).then(function(){});if(t&&t.then)return t.then(function(){})})});return o&&o.then?o.then(i):i()})}catch(n){return Promise.reject(n)}};n.exists=c,n.isDir=s,n.writeFile=function(n,e){try{var r=n.split("/");r.pop();var i=r.join("/");return Promise.resolve(c(i)).then(function(r){function o(){return new Promise(function(r){t.writeFile(n,e,function(n){r(!n)})})}var u=function(){if(!r)return Promise.resolve(a(i)).then(function(){})}();return u&&u.then?u.then(o):o()})}catch(n){return Promise.reject(n)}},n.writeJson=function(n,e){try{var r=n.split("/");r.pop();var i=r.join("/");return Promise.resolve(c(i)).then(function(r){function o(){return new Promise(function(r){t.writeFile(n,JSON.stringify(e,null,2),function(n){r(!n)})})}var u=function(){if(!r)return Promise.resolve(a(i)).then(function(){})}();return u&&u.then?u.then(o):o()})}catch(n){return Promise.reject(n)}},n.readdir=l,n.readFile=function(n){return new Promise(function(e){t.readFile(n,function(n,t){e(n?null:t)})})},n.readText=function(n){return new Promise(function(e){t.readFile(n,function(n,t){e(n?null:t.toString())})})},n.readJson=function(n){return new Promise(function(e){t.readFile(n,function(n,t){(t=t.toString()||null)&&(t=JSON.parse(t)),e(n?null:t)})})},n.mkdir=a,n.deleteDir=m,n.deleteFile=h});
