import n from"fs";import t from"path";const r=function(){function n(){}return n.prototype.then=function(t,r){const o=new n,i=this.s;if(i){const n=1&i?t:r;if(n){try{e(o,1,n(this.v))}catch(n){e(o,2,n)}return o}return this}return this.o=function(n){try{const i=n.v;1&n.s?e(o,1,t?t(i):i):r?e(o,1,r(i)):e(o,2,i)}catch(n){e(o,2,n)}},o},n}();function e(n,t,o){if(!n.s){if(o instanceof r){if(!o.s)return void(o.o=e.bind(null,n,t));1&t&&(t=o.s),o=o.v}if(o&&o.then)return void o.then(e.bind(null,n,t),e.bind(null,n,2));n.s=t,n.v=o;const i=n.o;i&&i(n)}}function o(n){return n instanceof r&&1&n.s}const i="undefined"!=typeof Symbol?Symbol.iterator||(Symbol.iterator=Symbol("Symbol.iterator")):"@@iterator";function u(n,t,u){if("function"==typeof n[i]){var c,f,s,l=n[i]();if(function n(i){try{for(;!((c=l.next()).done||u&&u());)if((i=t(c.value))&&i.then){if(!o(i))return void i.then(n,s||(s=e.bind(null,f=new r,2)));i=i.v}f?e(f,1,i):f=i}catch(n){e(f||(f=new r),2,n)}}(),l.return){var h=function(n){try{c.done||l.return()}catch(n){}return n};if(f&&f.then)return f.then(h,function(n){throw h(n)});h()}return f}if(!("length"in n))throw new TypeError("Object is not iterable");for(var a=[],m=0;m<n.length;m++)a.push(n[m]);return function(n,t,i){var u,c,f=-1;return function s(l){try{for(;++f<n.length&&(!i||!i());)if((l=t(f))&&l.then){if(!o(l))return void l.then(s,c||(c=e.bind(null,u=new r,2)));l=l.v}u?e(u,1,l):u=l}catch(n){e(u||(u=new r),2,n)}}(),u}(a,function(n){return t(a[n])},u)}"undefined"!=typeof Symbol&&(Symbol.asyncIterator||(Symbol.asyncIterator=Symbol("Symbol.asyncIterator")));var c=function(t){return new Promise(function(r){n.access(t,n.constants.F_OK,function(n){r(!n)})})},f=function(t){return new Promise(function(r){n.stat(t,function(n,t){r(!n&&t.isDirectory())})})},s=function(t,r){try{var e=t.split("/");e.pop();var o=e.join("/");return Promise.resolve(c(o)).then(function(e){function i(){return new Promise(function(e){n.writeFile(t,r,function(n){e(!n)})})}var u=function(){if(!e)return Promise.resolve(y(o)).then(function(){})}();return u&&u.then?u.then(i):i()})}catch(n){return Promise.reject(n)}},l=function(t,r){try{var e=t.split("/");e.pop();var o=e.join("/");return Promise.resolve(c(o)).then(function(e){function i(){return new Promise(function(e){n.writeFile(t,JSON.stringify(r,null,2),function(n){e(!n)})})}var u=function(){if(!e)return Promise.resolve(y(o)).then(function(){})}();return u&&u.then?u.then(i):i()})}catch(n){return Promise.reject(n)}},h=function(t){return new Promise(function(r){n.readdir(t,function(n,t){r(t||[])})})},a=function(t){return new Promise(function(r){n.readFile(t,function(n,t){r(n?null:t)})})},m=function(t){return new Promise(function(r){n.readFile(t,function(n,t){r(n?null:t.toString())})})},v=function(t){return new Promise(function(r){n.readFile(t,function(n,t){(t=t.toString()||null)&&(t=JSON.parse(t)),r(n?null:t)})})},y=function(t){try{var r=t.split("/");return r.pop(),Promise.resolve(c(r.join("/"))).then(function(e){function o(){return new Promise(function(r){n.mkdir(t,function(){try{return Promise.resolve(c(t)).then(function(n){r(n)})}catch(n){return Promise.reject(n)}})})}var i=function(){if(!e)return Promise.resolve(y(r.join("/"))).then(function(){})}();return i&&i.then?i.then(o):o()})}catch(n){return Promise.reject(n)}},P=function(t){return new Promise(function(r){n.unlink(t,function(n){r(!n)})})},d=function(r){try{return Promise.resolve(h(r)).then(function(e){function o(){return new Promise(function(t){n.rmdir(r,function(n){t(!n)})})}var i=u(e,function(n){var e=t.join(r,n);return Promise.resolve(f(e)).then(function(n){var t=n?Promise.resolve(d(e)).then(function(){}):Promise.resolve(P(e)).then(function(){});if(t&&t.then)return t.then(function(){})})});return i&&i.then?i.then(o):o()})}catch(n){return Promise.reject(n)}};export{c as exists,f as isDir,s as writeFile,l as writeJson,h as readdir,a as readFile,m as readText,v as readJson,y as mkdir,d as deleteDir,P as deleteFile};
